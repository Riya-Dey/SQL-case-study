create database if not exists steave_car_showroom;
use steave_car_showroom;

CREATE TABLE cars (
car_id INT PRIMARY KEY,
make VARCHAR(50),
type VARCHAR(50),
style VARCHAR(50),
cost_$ INT
);
--------------------
INSERT INTO cars (car_id, make, type, style, cost_$)
VALUES (1, 'Honda', 'Civic', 'Sedan', 30000),
(2, 'Toyota', 'Corolla', 'Hatchback', 25000),
(3, 'Ford', 'Explorer', 'SUV', 40000),
(4, 'Chevrolet', 'Camaro', 'Coupe', 36000),
(5, 'BMW', 'X5', 'SUV', 55000),
(6, 'Audi', 'A4', 'Sedan', 48000),
(7, 'Mercedes', 'C-Class', 'Coupe', 60000),
(8, 'Nissan', 'Altima', 'Sedan', 26000);
--------------------
CREATE TABLE salespersons (
salesman_id INT PRIMARY KEY,
name VARCHAR(50),
age INT,
city VARCHAR(50)
);
--------------------
INSERT INTO salespersons (salesman_id, name, age, city)
VALUES (1, 'John Smith', 28, 'New York'),
(2, 'Emily Wong', 35, 'San Fran'),
(3, 'Tom Lee', 42, 'Seattle'),
(4, 'Lucy Chen', 31, 'LA');
--------------------
CREATE TABLE sales (
sale_id INT PRIMARY KEY,
car_id INT,
salesman_id INT,
purchase_date DATE,
FOREIGN KEY (car_id) REFERENCES cars(car_id),
FOREIGN KEY (salesman_id) REFERENCES salespersons(salesman_id)
);
--------------------
INSERT INTO sales (sale_id, car_id, salesman_id, purchase_date)
VALUES (1, 1, 1, '2021-01-01'),
(2, 3, 3, '2021-02-03'),
(3, 2, 2, '2021-02-10'),
(4, 5, 4, '2021-03-01'),
(5, 8, 1, '2021-04-02'),
(6, 2, 1, '2021-05-05'),
(7, 4, 2, '2021-06-07'),
(8, 5, 3, '2021-07-09'),
(9, 2, 4, '2022-01-01'),
(10, 1, 3, '2022-02-03'),
(11, 8, 2, '2022-02-10'),
(12, 7, 2, '2022-03-01'),
(13, 5, 3, '2022-04-02'),
(14, 3, 1, '2022-05-05'),
(15, 5, 4, '2022-06-07'),
(16, 1, 2, '2022-07-09'),
(17, 2, 3, '2023-01-01'),
(18, 6, 3, '2023-02-03'),
(19, 7, 1, '2023-02-10'),
(20, 4, 4, '2023-03-01');

---------------------------------------------------------------
-- Now i will try to solve the problems,,,,,

-- Let's see the tables for better understanding,,,

select * from cars;
select * from salespersons;
select * from sales;

-----------------------------------------------------------------
-- Let's see the 1st question

/* 1. What are the details of all cars purchased in the year 2022? */

select s.car_id as "Car ID", s.purchase_date as "Purchase Date", c.make as "Brand", c.type as "Car Type", c.style as "Car Style", c.cost_$ as "Price($)"
from cars as c
inner join sales as s on s.car_id = c.car_id
where year(s.purchase_date) = '2022' ;

--------------------------------------------------------------------
-- Let's see the 2nd question

/* 2. What is the total number of cars sold by each salesperson? */

select sp.name as "Salesperson", count(s.car_id) as "No. of Sale"
from sales as s
inner join salespersons as sp on s.salesman_id = sp.salesman_id
group by sp.name;

--------------------------------------------------------------------
-- Let's see the 3rd question

/* 3. What is the total revenue generated by each salesperson? */

select sp.name as "Salesperson", sum(c.cost_$) as "Total Revenue($)"
from salespersons as sp
inner join sales as s on sp.salesman_id = s.salesman_id
inner join cars as c on c.car_id = s.car_id
group by sp.name
order by sum(c.cost_$) desc;

--------------------------------------------------------------------
-- Let's see the 4th question

/* 4. What are the details of the cars sold by each salesperson? */

select sp.name as "Sales Person", c.make as "Brand", c.type as "Car Type", c.style as "Car Style"
from cars as c
inner join sales as s on s.car_id = c.car_id
inner join salespersons as sp on sp.salesman_id = s.salesman_id
group by s.sale_id
order by sp.name;

--------------------------------------------------------------------
-- Let's see the 5th question

/* 5. What is the total revenue generated by each car type? */

select c.type as "Car Type", sum(c.cost_$) as "Total Revenue($)"
from cars as c
inner join sales as s on c.car_id = s.car_id
group by c.car_id
order by sum(c.cost_$)desc; 

--------------------------------------------------------------------
-- Let's see the 6th question

/* 6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'? */

select sp.name as "Salesperson", s.purchase_date as "Purchase Date", c.make as "Brand", c.type as "Car Type", c.style as "Car Style"
from cars as c
inner join sales as s on s.car_id = c.car_id
inner join salespersons as sp on sp.salesman_id = s.salesman_id
where year(s.purchase_date) = '2021' and sp.name = 'Emily Wong';

--------------------------------------------------------------------
-- Let's see the 7th question

/* 7. What is the total revenue generated by the sales of hatchback cars? */

select c.style as "Car Style", sum(c.cost_$) as "Total Revenue"
from cars as c
inner join sales as s on s.car_id = c.car_id
where c.style = 'Hatchback';

--------------------------------------------------------------------
-- Let's see the 8th question

/* 8. What is the total revenue generated by the sales of SUV cars in the year 2022? */

select c.style as "Car Style", sum(c.cost_$) as "Total Revenue"
from cars as c
inner join sales as s on s.car_id = c.car_id
where c.style = 'SUV' and year(s.purchase_date) = '2022';

--------------------------------------------------------------------
-- Let's see the 9th question

/* 9. What is the name and city of the salesperson who sold the most number of cars in the year 2023? */

select sp.name as "Sales Person", sp.city as "City"
from salespersons as sp
inner join sales as s on sp.salesman_id = s.salesman_id
where year(s.purchase_date) = 2023
group by s.salesman_id
order by count(s.salesman_id) desc limit 1;

--------------------------------------------------------------------
-- Let's see the 10th question

/* 10. What is the name and age of the salesperson who generated the highest revenue in the year 2022? */

select sp.name as "Sales Person", sp.age as "Age", sum(c.cost_$)
from salespersons as sp
inner join sales as s on sp.salesman_id = s.salesman_id
inner join cars as c on s.car_id = c.car_id
where year(s.purchase_date) = '2022'
group by sp.name
order by sum(c.cost_$) desc ;

-----------------------------------------------------------------------------

-- Thank You

